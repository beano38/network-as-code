- name: "########### STEP1: All Active Anycast EVPN IRB"
  nso_config:
    url: "http://172.28.128.3:8080/jsonrpc"
    username: "admin"
    password: "admin"
    data:
      evpn_irb:evpn_irb:
      - name: EPH
        device:
        - EVPN-PE0-RTR
        - EVPN-PE0-RTR
        - EVPN-PE0-RTR
        - EVPN-PE1-RTR
        - EVPN-PE0-RTR
        - EVPN-PE1-RTR
        vrfs:
          vrf:
          - vrf_name: EPH_INTERNET
            description: INTERNET
            my_bgp_as: 65000
            my_vrf_community: 301
            v4_imports:
            - vrf_community: 1
              bgp_as: 65000
          - vrf_name: EPH_VOICE
            description: VOICE
            my_bgp_as: 65000
            my_vrf_community: 302
            v4_imports:
            - vrf_community: 2
              bgp_as: 65000
          - vrf_name: EPH_VIDEO
            description: VIDEO
            my_bgp_as: 65000
            my_vrf_community: 303
            v4_imports:
            - vrf_community: 3
              bgp_as: 65000
        bgp:
          bgp_as: 65000
          vrf:
          - vrf_name: EPH_INTERNET
          - vrf_name: EPH_VOICE
          - vrf_name: EPH_VIDEO
        interfaces:
          interface:
          - interface_type: BVI
            interface_number: 301
            description: EPH_INTERNET
            ipv4_address: 172.17.201.1
            ipv4_mask: 255.255.255.0
            vrf: EPH_INTERNET
            mac_address: badb.a301.0010
          - interface_type: BVI
            interface_number: 302
            description: EPH_VOICE
            ipv4_address: 172.17.202.1
            ipv4_mask: 255.255.255.0
            vrf: EPH_VOICE
            mac_address: badb.a302.0010
          - interface_type: BVI
            interface_number: 303
            description: EPH_VIDEO
            ipv4_address: 172.17.203.1
            ipv4_mask: 255.255.255.0
            vrf: EPH_VIDEO
            mac_address: badb.a303.0010
        evpn:
          evi:
          - evi_id: 301
          - evi_id: 302
          - evi_id: 303
        l2vpn:
          group_name: EPH_OLTS
          bridge_domain:
          - bd_name: INTERNET
            interface:
            - interface_type: BVI
              interface_number: 301
            evi_id: 301
          - bd_name: VOICE
            interface:
            - interface_type: BVI
              interface_number: 302
            evi_id: 302
          - bd_name: VIDEO
            interface:
            - interface_type: BVI
              interface_number: 303
            evi_id: 303

    
      olt_deploy:olt_deploy:
      - name: EPH
        pe:
        - device: EVPN-PE0-RTR
          interfaces:
            interface:
            - interface_type: Bundle-Ether
              interface_number: 30
              description: EPH_ROLT10
              lacp_mode: active
              lacp_mac_address: badb.ad30.0010
            - interface_type: Bundle-Ether
              interface_number: 30.301
              description: INTERNET
              outer_vlan: 301
            - interface_type: Bundle-Ether
              interface_number: 30.302
              description: VOICE
              outer_vlan: 302
            - interface_type: Bundle-Ether
              interface_number: 30.303
              description: VIDEO
              outer_vlan: 303
            - interface_type: TenGigE
              interface_number: 0/0/0/10
              description: EPH_ROLT10
              bundle_id: 30
              lacp_mode: active
        - device: EVPN-PE0-RTR
          interfaces:
            interface:
            - interface_type: Bundle-Ether
              interface_number: 30
              description: EPH_ROLT10
              lacp_mode: active
              lacp_mac_address: badb.ad30.0010
            - interface_type: Bundle-Ether
              interface_number: 30.301
              description: INTERNET
              outer_vlan: 301
            - interface_type: Bundle-Ether
              interface_number: 30.302
              description: VOICE
              outer_vlan: 302
            - interface_type: Bundle-Ether
              interface_number: 30.303
              description: VIDEO
              outer_vlan: 303
            - interface_type: TenGigE
              interface_number: 0/0/0/10
              description: EPH_ROLT10
              bundle_id: 30
              lacp_mode: active
          evpn:
            interface:
            - interface_type: Bundle-Ether
              interface_number: 30
              esi_identifier: 10.6e.65.62.72.65.64.6c.65.30
          l2vpn:
            group_name: EPH_OLTS
            bridge_domain:
            - bd_name: INTERNET
              interface:
              - interface_type: Bundle-Ether
                interface_number: 30.301
            - bd_name: VOICE
              interface:
              - interface_type: Bundle-Ether
                interface_number: 30.302
            - bd_name: VIDEO
              interface:
              - interface_type: Bundle-Ether
                interface_number: 30.303
      - name: EPH
        pe:
        - device: EVPN-PE0-RTR
          interfaces:
            interface:
            - interface_type: Bundle-Ether
              interface_number: 11
              description: EPH_ROLT11
              lacp_mode: active
              lacp_mac_address: badb.ad11.0010
            - interface_type: Bundle-Ether
              interface_number: 11.301
              description: INTERNET
              outer_vlan: 301
            - interface_type: Bundle-Ether
              interface_number: 11.302
              description: VOICE
              outer_vlan: 302
            - interface_type: Bundle-Ether
              interface_number: 11.303
              description: VIDEO
              outer_vlan: 303
            - interface_type: TenGigE
              interface_number: 0/0/0/11
              description: EPH_ROLT11
              bundle_id: 11
              lacp_mode: active
        - device: EVPN-PE1-RTR
          interfaces:
            interface:
            - interface_type: Bundle-Ether
              interface_number: 11
              description: EPH_ROLT11
              lacp_mode: active
              lacp_mac_address: badb.ad11.0010
            - interface_type: Bundle-Ether
              interface_number: 11.301
              description: INTERNET
              outer_vlan: 301
            - interface_type: Bundle-Ether
              interface_number: 11.302
              description: VOICE
              outer_vlan: 302
            - interface_type: Bundle-Ether
              interface_number: 11.303
              description: VIDEO
              outer_vlan: 303
            - interface_type: TenGigE
              interface_number: 0/0/0/11
              description: EPH_ROLT11
              bundle_id: 11
              lacp_mode: active
          evpn:
            interface:
            - interface_type: Bundle-Ether
              interface_number: 11
              esi_identifier: 10.6e.65.62.72.65.64.6c.65.11
          l2vpn:
            group_name: EPH_OLTS
            bridge_domain:
            - bd_name: INTERNET
              interface:
              - interface_type: Bundle-Ether
                interface_number: 11.301
            - bd_name: VOICE
              interface:
              - interface_type: Bundle-Ether
                interface_number: 11.302
            - bd_name: VIDEO
              interface:
              - interface_type: Bundle-Ether
                interface_number: 11.303
      - name: EPH
        pe:
        - device: EVPN-PE0-RTR
          interfaces:
            interface:
            - interface_type: Bundle-Ether
              interface_number: 12
              description: EPH_ROLT12
              lacp_mode: active
              lacp_mac_address: badb.ad12.0010
            - interface_type: Bundle-Ether
              interface_number: 12.301
              description: INTERNET
              outer_vlan: 301
            - interface_type: Bundle-Ether
              interface_number: 12.302
              description: VOICE
              outer_vlan: 302
            - interface_type: Bundle-Ether
              interface_number: 12.303
              description: VIDEO
              outer_vlan: 303
            - interface_type: TenGigE
              interface_number: 0/0/0/12
              description: EPH_ROLT12
              bundle_id: 12
              lacp_mode: active
        - device: EVPN-PE1-RTR
          interfaces:
            interface:
            - interface_type: Bundle-Ether
              interface_number: 12
              description: EPH_ROLT12
              lacp_mode: active
              lacp_mac_address: badb.ad12.0010
            - interface_type: Bundle-Ether
              interface_number: 12.301
              description: INTERNET
              outer_vlan: 301
            - interface_type: Bundle-Ether
              interface_number: 12.302
              description: VOICE
              outer_vlan: 302
            - interface_type: Bundle-Ether
              interface_number: 12.303
              description: VIDEO
              outer_vlan: 303
            - interface_type: TenGigE
              interface_number: 0/0/0/12
              description: EPH_ROLT12
              bundle_id: 12
              lacp_mode: active
          evpn:
            interface:
            - interface_type: Bundle-Ether
              interface_number: 12
              esi_identifier: 10.6e.65.62.72.65.64.6c.65.12
          l2vpn:
            group_name: EPH_OLTS
            bridge_domain:
            - bd_name: INTERNET
              interface:
              - interface_type: Bundle-Ether
                interface_number: 12.301
            - bd_name: VOICE
              interface:
              - interface_type: Bundle-Ether
                interface_number: 12.302
            - bd_name: VIDEO
              interface:
              - interface_type: Bundle-Ether
                interface_number: 12.303
